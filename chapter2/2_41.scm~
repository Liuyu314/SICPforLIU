(define (accumulate op initial sequence)
  (if (null? sequence)
      initial
      (op (car sequence)
          (accumulate op initial (cdr sequence)))))

(define (make-2-list n)
  (define (go-on? pair)
	(> (- n (cadr pair)) 0))
  (filter go-on?
		  (flatmap
			(lambda (i)
			  (map (lambda (j) (list i j))
				   (enumerate-interval (+ i 1) n)))
			(enumerate-interval 1 n))))

(define (make-3-list n)
  (flatmap
	  (lambda (pair)
		(map (lambda (k) (append pair (list k)))
			 (enumerate-interval (+ (cadr pair) 1) n)))
	  (make-2-list n)))

(define (make-s-sum s n)
  (define lst (make-3-list n))
  (define (sum-ok? lst)
	(= (+ (car lst) (cadr lst) (cadr (cdr lst))) s))
  (filter sum-ok?
		  lst))

(define (flatmap proc seq)
  (accumulate append '() (map proc seq)))

(define (prime-sum? pair)
  (prime? (+ (car pair) (cadr pair))))

(define (make-pair-sum pair)
  (list (car pair) (cadr pair) (+ (car pair) (cadr pair))))

(define (enumerate-interval low high)
  (if (> low high)
	'()
	(cons low (enumerate-interval (+ low 1) high))))
